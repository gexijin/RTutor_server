version: '2.2'
services:
  webapp:
    build: .
    image: webapp
    mem_limit: 6g
    mem_reservation: 2g
    mem_swappiness: 20
    cpus: "2.0"
    env_file:
     - api.env
    expose:
      - "3838"
    volumes:
      - ./shinyapps/:/srv/shiny-server/
      - ./data/:/srv/data/
      - ./shinylog/:/var/log/shiny-server/
      - ./config/:/etc/shiny-server/
      - ./classes/:/usr/local/src/myscripts/
        #    command: ["/usr/bin/shiny-server.sh"]
    
  nginx:
    build: ./nginx
    image: nginx
    cpus: "0.5"
    links:
        - webapp
    ports:
        - "80:80"
